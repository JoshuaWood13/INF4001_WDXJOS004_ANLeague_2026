@model INF4001_WDXJOS004_ANLeague_2026.Models.ViewModels.TeamDetailsViewModel

<div class="container mt-4">

    <!-- Header -->
    <div class="text-center mb-3">
        <h2 class="fw-bold">@Model.Country.Name National Team</h2>
    </div>

    <!-- Success/Error Messages -->
    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success alert-dismissible fade show error-message position-fixed"
             style="top: 80px; right: 20px; z-index: 1100; max-width: 400px;" id="successMessage">
            <strong>Success!</strong> @TempData["SuccessMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }
    @if (TempData["ErrorMessage"] != null)
    {
        <div class="alert alert-danger alert-dismissible fade show error-message position-fixed"
             style="top: 80px; right: 20px; z-index: 1100; max-width: 400px;" id="errorMessage">
            <strong>Error!</strong> @TempData["ErrorMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }
    @if (TempData["InfoMessage"] != null)
    {
        <div class="alert alert-info alert-dismissible fade show error-message position-fixed"
             style="top: 80px; right: 20px; z-index: 1100; max-width: 400px;" id="infoMessage">
            <strong>Info!</strong> @TempData["InfoMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    @if (!Model.Country.IsTeamComplete)
    {
        <!-- Team Not Created -->
        <div class="card shadow mb-4">
            <div class="card-header bg-warning text-dark">
                <h3 class="mb-0">Team Not Created</h3>
            </div>
            <div class="card-body text-center">
                <p class="lead">Your team has not been created yet.</p>
                <p>Create your team with 23 players, select a manager, and choose a captain.</p>
                <a asp-action="CreateTeam" class="btn btn-success btn-lg">Create Team</a>
            </div>
        </div>
    }
    else
    {
        <!-- Team Header -->
        <div class="card shadow mb-4">
            <div class="card-header bg-primary text-white">
                <h2 class="mb-0">Statistics</h2>
            </div>
            <div class="card-body">
                <div class="row g-3 align-items-center">

                    <!-- Team Info -->
                    <div class="col-md-4">
                        <div class="border rounded p-3 h-100">
                            <div class="mb-2"><strong>Manager</strong></div>
                            <div class="fs-5">@Model.Country.ManagerName</div>
                            <hr />
                            <div class="mb-2"><strong>Captain</strong></div>
                            <div class="fs-5">@Model.CaptainName</div>
                            <hr />
                            <div class="mb-2"><strong>Rating</strong></div>
                            <div class="fs-4 fw-bold">@Model.Country.Rating.ToString("F0")</div>
                        </div>
                    </div>

                    <!-- Team Stats-->
                    <div class="col-md-8 d-flex align-items-center">
                        <div class="row g-3 w-100">
                            <div class="col-6 col-lg-4">
                                <div class="border rounded text-center p-3 h-100">
                                    <div class="text-muted">Tournaments Won</div>
                                    <div class="display-6">@Model.Country.Statistics.TournamentsWon</div>
                                </div>
                            </div>
                            <div class="col-6 col-lg-4">
                                <div class="border rounded text-center p-3 h-100">
                                    <div class="text-muted">Matches Played</div>
                                    <div class="display-6">@Model.Country.Statistics.MatchesPlayed</div>
                                </div>
                            </div>
                            <div class="col-6 col-lg-4">
                                <div class="border rounded text-center p-3 h-100">
                                    <div class="text-muted">Wins</div>
                                    <div class="display-6 text-success">@Model.Country.Statistics.Wins</div>
                                </div>
                            </div>
                            <div class="col-6 col-lg-4">
                                <div class="border rounded text-center p-3 h-100">
                                    <div class="text-muted">Losses</div>
                                    <div class="display-6 text-danger">@Model.Country.Statistics.Losses</div>
                                </div>
                            </div>
                            <div class="col-6 col-lg-4">
                                <div class="border rounded text-center p-3 h-100">
                                    <div class="text-muted">Draws</div>
                                    <div class="display-6">@Model.Country.Statistics.Draws</div>
                                </div>
                            </div>
                            <div class="col-6 col-lg-4">
                                <div class="border rounded text-center p-3 h-100">
                                    <div class="text-muted">Win/Loss %</div>
                                    <div class="display-6">@Model.WinLossPercentage.ToString("F2")%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Players -->
        <div class="card shadow">
            <div class="card-header bg-info text-white">
                <h3 class="mb-0">Players</h3>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th class="text-center">Natural Position</th>
                                <th class="text-center">GK Rating</th>
                                <th class="text-center">DF Rating</th>
                                <th class="text-center">MD Rating</th>
                                <th class="text-center">AT Rating</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (Model.Country.Players != null && Model.Country.Players.Any())
                            {
                                @foreach (var player in Model.Country.Players.OrderBy(p => p.NaturalPosition).ThenBy(p => p.Name))
                                {
                                    <tr>
                                        <td>
                                            @if (player.IsCaptain)
                                            {
                                                <span style="color: darkorange; font-weight: 600;">@player.Name (C)</span>
                                            }
                                            else
                                            {
                                                @player.Name
                                            }
                                        </td>
                                        <td class="text-center">@player.NaturalPosition</td>
                                        <td class="text-center">@player.Ratings.GK</td>
                                        <td class="text-center">@player.Ratings.DF</td>
                                        <td class="text-center">@player.Ratings.MD</td>
                                        <td class="text-center">@player.Ratings.AT</td>
                                    </tr>
                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="6" class="text-center">No players found</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    }
</div>

@section Scripts {
    <script>
        // Hide temp data messages after 3 seconds
        $(document).ready(function () {
            var $successMessage = $('#successMessage');
            var $errorMessage = $('#errorMessage');
            var $infoMessage = $('#infoMessage');

            if ($successMessage.length) {
                setTimeout(function () {
                    $successMessage.fadeOut(500, function () {
                        $(this).remove();
                    });
                }, 3000);
            }

            if ($errorMessage.length) {
                setTimeout(function () {
                    $errorMessage.fadeOut(500, function () {
                        $(this).remove();
                    });
                }, 3000);
            }

            if ($infoMessage.length) {
                setTimeout(function () {
                    $infoMessage.fadeOut(500, function () {
                        $(this).remove();
                    });
                }, 3000);
            }
        });
    </script>
}
